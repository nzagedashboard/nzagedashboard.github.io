{
  "articles": [
    {
      "path": "README.html",
      "author": [],
      "contents": "\nNZAGE Survey Dashbaord\nThis repo creates a dashboard summarising responses to the NZAGE Graduate, Intern and Employer survey, administered by Talent Solutions.\nSub-tasks/skills\nConnect to SurveyMonkey from API (surveymonkey package, creating an authentication token)\nUsing an R project (recommended, but possible to go without if not doing Distill site)\nFile management (list.files(), file.info())\nWrangling data (dplyr), including joins and fuzzy matching (fuzzyjoin).\nVisualizing data (ggplot2)\nCreate HTML files in R (can be a simple single page or use the Distill package to make a more polished multipage site)\nGit and GitHub\ncrontab on Linux/Mac terminals (I think there are reasonably equivalent things on Windows, but don’t know them)\nTechnical set up\nMy session info:\nNote: I did this on a Mac. That set up will be different for a Windows machine.\n> sessionInfo()\nR version 3.6.2 (2019-12-12)\nPlatform: x86_64-apple-darwin15.6.0 (64-bit)\nRunning under: macOS  10.16\nAutomation is the hardest part (for me at least)\nPretty reliably you should be able to get this down to just needing to run one line to have everything else happen, it is setting up the crontab to run that I had the most trouble with, though it is super rewarding when it does work. This was less due to the crontab syntax and more the just getting all the permissions (GitHub, files executable, Full Disk writable) and paths sorted out.\nHere is what I landed on, but some of these instructions are probably just superstition…Google is your friend when it comes to tackling this on your own machine.\nFirstly, you need to allow the bash script to be executed before putting it in a crontab job. You can do this with: chmod +x ~/Documents/GitHub/nzagedashboard.github.io/nzagedashboard_driver.sh.\nMake sure your GitHub credentials are set up, you want the SSH version. Just google whatever GitHub’s latest advice is.\nI had issues getting the correct version of pandoc to be applied, so you have to put it explicitly in the R code that is run.\nThis is my nzagedashboard.sh file:\ncd ~/Documents/GitHub/nzagedashboard.github.io\n/usr/local/bin/Rscript -e 'Sys.setenv(RSTUDIO_PANDOC=\"/Applications/RStudio.app/Contents/MacOS/pandoc\");\n                            source(\"~/Documents/GitHub/nzagedashboard.github.io/connect_API.R\");\n                            rmarkdown::render_site(encoding = \"UTF-8\");\n                            rmarkdown::clean_site()'\ngit add -A\ngit commit -m \"Autoupdate\"\ngit push\nThis code sets the working directory to my folder for this project, then (line 2) it sets up using R to run 4 commands, first, set where to find pandoc, second, run the script that accessed the API (I’ve kept this in a separate file because it makes it easier to remove it when testing so I don’t hit the API limit), third, the site is rendered, in the process, the data is loaded and run and the visualizations updated, finally the unneeded files are cleaned up.\nMy crontab workflow\n(must have run the chmod +x ~/Documents/GitHub/nzagedashboard.github.io/nzagedashboard_driver.sh code)\nOpen Terminal\nType crontab -e and Enter/Return\nPress i to enter ‘Insert mode’ and add a line like this: 0 */3 * * * ~/Documents/GitHub/nzagedashboard.github.io/nzagedashboard_driver.sh. This says “run this script every three hours”. This site is really helpful for interpreting the cron syntax https://crontab.guru/#0_*/3_*_*_*\nWhen finished editing, pres Escape then type :wq to save and exit.\nYou can list your jobs with crontab -l.\nConnecting to the Survey Monkey API\nThis is the ‘instructions’ version of the code. The file that is actually run is connect_API.R.\n1. Install the required packages\nThe surveymonkey package makes it easier to access the Survey Monkey API in R. It is developed and maintained by TNTP, a nonprofit company working to end the injustice of educational inequality.\n```{r, eval} # for wrangling, viz, etc. if(!require(“tidyverse”)) { install.packages(“tidyverse”) }\neasy editting of R environments\nif(!require(“usethis”)) { install.packages(“usethis”) }\nNeed devtools install surveymonkey package from github\nif(!require(“devtools”)) { install.packages(“devtools”) }\nGet the dev version of surveymonkey package\nhttps://github.com/tntp/surveymonkey\ndevtools::install_github(“tntp/surveymonkey”)\n```\nlibrary(\"surveymonkey\")\nlibrary(\"tidyverse\")\n2. Set up an API key in Survey Monkey\nAt time of writing, you create your access token by making a new private app here: https://developer.surveymonkey.com/apps/.\nThen follow these instructions from the surveymonkey package documentation (or more updated authentication information):\nAdd the SurveyMonkey account’s OAuth token to your .Rprofile file. To open and edit that file, run usethis::edit_r_profile(), then add a line like this: options(sm_oauth_token = \"kmda332fkdlakfld8am7ml3dafka-dafknalkfmalkfad-THIS IS NOT THE REAL KEY THOUGH\").\nWARNING 1: Don’t share the token or accidentally add it on GitHub, etc.\nWARNING 2: Pay attention to the number of requests you are allowed to make in a day. At time of writing, 500.\nWARNING 3: Only 100 responses can be fetched per API call, a survey with X respondents will make at least X/100 calls to the API.\n# Get the latest 10 (or n) surveys so you can find the IDs for the surveys you want\nsurveys <- browse_surveys(10)\n3. Get the data\nHere I’m saving the data in .csv files that can be used as back up and more easily integrated into the site. It also means having this file be separate helps when testing other parts of the workflow.\n# This took 6 requests when last run\ngrads_raw <- 302886746 %>% \n  fetch_survey_obj %>%\n  parse_survey\n\ngrads_min <- grads_raw %>% \n  # Say that a submission is complete if they answered up to the disability question\n  # This increased the number of completes slightly. Should be checked in final processing.\n  mutate(complete = !is.na(`Do you identify as a person with a disability?`)) %>% \n  select(date_modified, response_status, \n         `Please tell us the organisation you joined as a graduate.`,\n         complete) %>% \n  rename(Employer = `Please tell us the organisation you joined as a graduate.`) \n\nwrite_csv(grads_min, str_c(\"Data/fromAPI/\", Sys.time(), \"_grads.csv\"))\n\n# This took 3 requests when last run\ninterns_raw <- 302886733 %>% \n  fetch_survey_obj %>%\n  parse_survey\n\ninterns_min <- interns_raw %>% \n  # Say that a submission is complete if they answered up to the disability question\n  # This increased the number of completes slightly. Should be checked in final processing.\n  mutate(complete = !is.na(`Do you identify as a person with a disability?`)) %>% \n  select(date_modified, response_status, \n         `With which organisation did you undertake your most recent internship?`,\n         complete) %>% \n  rename(Employer = `With which organisation did you undertake your most recent internship?`) \n\nwrite_csv(interns_min, str_c(\"Data/fromAPI/\", Sys.time(), \"_interns.csv\"))\n\n# This took 2 requests when last run\nemployers_raw <- 302886711 %>% \n  fetch_survey_obj %>%\n  parse_survey\n\nemployers_min <- employers_raw %>% \n  # Say that a submission is complete if they answered up to the disability question\n  # This increased the number of completes slightly. Should be checked in final processing.\n  mutate(complete = !is.na(`What challenges does your organisation face in transitioning graduates from their graduate programme to non-graduate roles, if any?`)) %>% \n  select(date_modified, response_status, \n         `What is the name of your organisation?`,\n         complete) %>% \n  rename(Employer = `What is the name of your organisation?`) \n\nwrite_csv(employers_min, str_c(\"Data/fromAPI/\", Sys.time(), \"_employers.csv\"))\n\n\n",
      "last_modified": "2021-08-07T20:41:39-04:00"
    },
    {
      "path": "about.html",
      "title": "FAQ",
      "author": [],
      "contents": "\nHow often is the dashboard updated?\nThe dashboard will be updated at least once a day. You can see the last time it was updated displayed at the top of the dashboard.\nI think there is a problem or mistake, what do I do?\nIf there are any issues with the dashboard, please email survey@talentsolutions.co.nz to let us know.\nWho created this?\nThis dashboard has been created by Talent Solutions for the New Zealand Association of Graduate Employers..\nTalent Solutions are early talent consulting and research specialists. Talent Solutions is dedicated to supporting your organisation to engage outstanding talent. Our core focus is early talent programmes – degree qualified graduates, interns, school-leavers and cadets.\nWhether you are looking to recruit one or one hundred graduates, we can equip you with the tools, technology, resource and specialist expertise to deliver great results.\n\n\n\n",
      "last_modified": "2021-08-07T20:41:34-04:00"
    },
    {
      "path": "index.html",
      "title": "Dashboard 2021",
      "description": "Status of responses for the NZAGE graduate, intern and employer surveys. Updated at least daily.\n",
      "author": [],
      "contents": "\n\nContents\nProgress to date\nSummary by organisation\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate as of 2021-08-08 12:41.\nProgress to date\nThe below charts show how we’re tracking for complete graduate, intern and employer surveys, as well as how many bespoke reports have been earned.\nNote on bespoke reports\nAn organisation earns a bespoke report when 10 or more of their graduates complete the graduate survey. They must also be a member of the NZAGE—this update data only reflects whether they have 10 or more complete graduate response. Double check NZAGE status before confirming with an organisation.\n\n\n\nResponses over time\n\n\n\nSummary by organisation\n\n\n\nThis sortable and searchable table shows all organisations that have had graduate, intern and/or employer responses in 2021. Only complete counts1 are included.\n\n{\"x\":{\"filter\":\"none\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\"],[\"2degrees\",\"ANZ\",\"ASB\",\"Auckland Council\",\"Audit New Zealand\",\"Aurecon\",\"BDO\",\"Baker Tilly Staples Rodway\",\"Beca\",\"Chapman Tripp\",\"Deloitte\",\"EY\",\"Intergen\",\"KPMG\",\"MBIE\",\"Ministry of Housing and Urban Development\",\"PowerCo\",\"Russell McVeagh\",\"Simpson Grierson\",\"Southern Institute of Technology\",\"The University of Auckland\",\"Tonkin + Taylor\",\"Toyota\",\"Transpower New Zealand\",\"WSP\",\"Xero\"],[\"Yes\",\"Yes\",\"No\",\"No\",\"No\",\"No\",\"Yes\",\"Yes\",\"No\",\"Yes\",\"Yes\",\"No\",\"Yes\",\"No\",\"Yes\",\"No\",\"Yes\",\"No\",\"No\",\"No\",\"Yes\",\"Yes\",\"Yes\",\"Yes\",\"Yes\",\"No\"],[5,16,22,7,11,9,23,4,42,9,47,21,12,46,12,3,4,6,14,1,4,7,6,6,34,25],[0,6,0,0,5,1,4,3,0,13,22,6,0,10,3,0,6,3,2,0,0,0,1,2,6,11],[\"No\",\"Yes\",\"Yes\",\"No\",\"Yes\",\"No\",\"Yes\",\"No\",\"Yes\",\"No\",\"Yes\",\"Yes\",\"Yes\",\"Yes\",\"Yes\",\"No\",\"No\",\"No\",\"Yes\",\"No\",\"No\",\"No\",\"No\",\"No\",\"Yes\",\"Yes\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Employer<\\/th>\\n      <th>Complete Employer Survey?<\\/th>\\n      <th>Grads<\\/th>\\n      <th>Interns<\\/th>\\n      <th>Bespoke report?<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}\nWhile we have used a two-stage automated checking approach to maximise correct coding of free text responses identifying the employer of each graduate and intern, these numbers may change somewhat with final data cleaning as unidentified or misidentified employers are corrected.↩︎\n",
      "last_modified": "2021-08-07T20:41:39-04:00"
    }
  ],
  "collections": []
}
